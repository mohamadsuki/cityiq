-- Create real users in auth.users table and set up their roles/departments

-- Insert real users into auth.users
INSERT INTO auth.users (
  id, 
  instance_id, 
  aud, 
  role, 
  email, 
  encrypted_password, 
  email_confirmed_at, 
  invited_at, 
  confirmation_token, 
  confirmation_sent_at, 
  recovery_token, 
  recovery_sent_at, 
  email_change_token_new, 
  email_change, 
  email_change_sent_at, 
  last_sign_in_at, 
  raw_app_meta_data, 
  raw_user_meta_data, 
  is_super_admin, 
  created_at, 
  updated_at, 
  phone, 
  phone_confirmed_at, 
  phone_change, 
  phone_change_token, 
  phone_change_sent_at, 
  email_change_token_current, 
  email_change_confirm_status, 
  banned_until, 
  reauthentication_token, 
  reauthentication_sent_at
) VALUES 
(
  '11111111-1111-1111-1111-111111111111'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'mayor@city.gov.il', 
  crypt('mayor123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"ראש העיר"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '22222222-2222-2222-2222-222222222222'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'ceo@city.gov.il', 
  crypt('ceo123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנכל העירייה"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '33333333-3333-3333-3333-333333333333'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'finance@city.gov.il', 
  crypt('finance123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל פיננסים"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '44444444-4444-4444-4444-444444444444'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'education@city.gov.il', 
  crypt('education123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל חינוך"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '55555555-5555-5555-5555-555555555555'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'engineering@city.gov.il', 
  crypt('engineering123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל הנדסה"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '66666666-6666-6666-6666-666666666666'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'welfare@city.gov.il', 
  crypt('welfare123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל רווחה"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '77777777-7777-7777-7777-777777777777'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'non-formal@city.gov.il', 
  crypt('nonformal123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל חינוך בלתי פורמאלי"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
),
(
  '88888888-8888-8888-8888-888888888888'::uuid, 
  '00000000-0000-0000-0000-000000000000', 
  'authenticated', 
  'authenticated', 
  'business@city.gov.il', 
  crypt('business123', gen_salt('bf')), 
  now(), 
  null, 
  '', 
  null, 
  '', 
  null, 
  '', 
  '', 
  null, 
  null, 
  '{"provider":"email","providers":["email"]}', 
  '{"display_name":"מנהל רישוי עסקים"}', 
  false, 
  now(), 
  now(), 
  null, 
  null, 
  '', 
  '', 
  null, 
  '', 
  0, 
  null, 
  '', 
  null
)
ON CONFLICT (id) DO NOTHING;

-- Insert user roles
INSERT INTO public.user_roles (user_id, role) VALUES
('11111111-1111-1111-1111-111111111111', 'mayor'::app_role),
('22222222-2222-2222-2222-222222222222', 'ceo'::app_role),
('33333333-3333-3333-3333-333333333333', 'manager'::app_role),
('44444444-4444-4444-4444-444444444444', 'manager'::app_role),
('55555555-5555-5555-5555-555555555555', 'manager'::app_role),
('66666666-6666-6666-6666-666666666666', 'manager'::app_role),
('77777777-7777-7777-7777-777777777777', 'manager'::app_role),
('88888888-8888-8888-8888-888888888888', 'manager'::app_role)
ON CONFLICT (user_id, role) DO NOTHING;

-- Insert user departments
INSERT INTO public.user_departments (user_id, department) VALUES
-- Mayor - access to all departments
('11111111-1111-1111-1111-111111111111', 'finance'::department_slug),
('11111111-1111-1111-1111-111111111111', 'education'::department_slug),
('11111111-1111-1111-1111-111111111111', 'engineering'::department_slug),
('11111111-1111-1111-1111-111111111111', 'welfare'::department_slug),
('11111111-1111-1111-1111-111111111111', 'non-formal'::department_slug),
('11111111-1111-1111-1111-111111111111', 'business'::department_slug),
('11111111-1111-1111-1111-111111111111', 'city-improvement'::department_slug),
('11111111-1111-1111-1111-111111111111', 'enforcement'::department_slug),
('11111111-1111-1111-1111-111111111111', 'ceo'::department_slug),

-- CEO - access to all departments
('22222222-2222-2222-2222-222222222222', 'finance'::department_slug),
('22222222-2222-2222-2222-222222222222', 'education'::department_slug),
('22222222-2222-2222-2222-222222222222', 'engineering'::department_slug),
('22222222-2222-2222-2222-222222222222', 'welfare'::department_slug),
('22222222-2222-2222-2222-222222222222', 'non-formal'::department_slug),
('22222222-2222-2222-2222-222222222222', 'business'::department_slug),
('22222222-2222-2222-2222-222222222222', 'city-improvement'::department_slug),
('22222222-2222-2222-2222-222222222222', 'enforcement'::department_slug),
('22222222-2222-2222-2222-222222222222', 'ceo'::department_slug),

-- Individual department managers
('33333333-3333-3333-3333-333333333333', 'finance'::department_slug),
('44444444-4444-4444-4444-444444444444', 'education'::department_slug),
('55555555-5555-5555-5555-555555555555', 'engineering'::department_slug),
('66666666-6666-6666-6666-666666666666', 'welfare'::department_slug),
('77777777-7777-7777-7777-777777777777', 'non-formal'::department_slug),
('88888888-8888-8888-8888-888888888888', 'business'::department_slug)
ON CONFLICT (user_id, department) DO NOTHING;